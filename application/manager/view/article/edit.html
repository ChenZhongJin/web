{extend name="layout"/} {block name="warp"}
<div class="container">
    <div class="row">
        <div class="w-100">
            <form action="" id="article">
                <div class="form-group">
                    {:token()}
                    <input type="hidden" name="id" value="{$data.id}">
                    <small>文章标题</small>
                    <input type="text" name="title" class="form-control" value="{$data.title}">
                </div>
                <div class="form-group">
                    <label for="category">所属分类</label>
                    <select class="form-control" id="category" name="category_id">
                        {foreach $categorys as $cat}
                        <option value="{$cat.id}" {if $data.category_id==$cat.id}selected{/if}>{$cat.cname}</option>
                        {/foreach}
                    </select>
                </div>
                <div class="form-group">
                    <label for="title">文章内容</label>
                    <textarea class="form-control" id="edit">{$data.content}</textarea>
                </div>
                <div class="form-group">
                    <label for="keywords">页面关键词</label>
                    <input type="text" class="form-control" value="{$data.keywords}">
                </div>
                <div class="form-group">
                    <label for="description">页面描述</label>
                    <textarea name="description" class="form-control">{$data.description}</textarea>
                </div>

                <div class="form-group">
                    {if $data.id}
                    <a href="{:url('_article_update')}" class="btn btn-sm btn-dark rounded-0" id="send">更新</a>
                    {else/}
                    <a href="{:url('_article_save')}" class="btn btn-sm btn-dark rounded-0" id="send">保存</a>
                    {/if}
                </div>
            </form>
        </div>
    </div>
</div> {/block} {block name="warpJS"} {include file="editor"/}
<script>
    (function () {
        var form = document.querySelector('form#article');
        form.querySelector('a#send').addEventListener('click', function (event) {
            event.preventDefault();
            var data = jQuery(form).serializeArray();
            data.push({ name: 'content', value: tinymce.get('edit').getContent() });
            ajax(event.target.href, data);
        })
    })()
</script> {/block}